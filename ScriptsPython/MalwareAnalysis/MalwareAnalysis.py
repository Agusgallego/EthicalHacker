# LIBRERIAS
import webbrowser # Libreria que permite abrir URLs en un navegador predeterminado, automatiza la apertura de paginas web directamente 
import pyperclip #facilita el copiado y pegado del texto en el portapapeles de un sistema. manipualcion de porta papeles
import pyautogui #controla el mouse y el teclado de forma programatica, automatiza tareas repetitivas en la interfaz grafica
import time #manipulacion del tiempo, como pausas o medir la duracion de ejecucion del codigo
from colorama import Fore, Style # estilos y colores para los scripts

#SCRIPT Automate MALWARE ANALYSIS with PYTHON


#abrimos el documento donde contenemos la IP y le damos permiso read 'r' => leer, y almacenamos ese resultado en documento
documento = open('direccionesIp.txt', 'r')
# indicamos que lea el documento, lintea por linea \n, indica este salto de linea
documento = documento.read().split('\n')


# MENSAJE QUE SE IMPRIME POR PANTALLA DANDO LAS INSTRUCCIÓNES AL USUARIO
# eleccion -> guarda el tipo de pagina que quiere utilizar el usuario, con un numero.
eleccion = input(Fore.GREEN + "escribir el nombre de la herramienta que quieras utilizar para analizar la direccion IP:" + Fore.YELLOW +
                 """ \n 1 - Symantec
                        2- AbuseIP
                        3- Virustotal: \n """ + "¿Cuál es tu elección?")   


if eleccion =="1":        #el usuario selecciono la web Symantec
    for ip in documento:  #entonces recorremos la variable documento, recolectando cada ip en cada salto de linea
        webbrowser.open_new("https://sitereview.bluecoat.com/#/") #abrimos la url de Symantec
        time.sleep(3) #le indicamos un tiempo de espera apenas abra la pagina (para que esta se cargue correctamente)
        pyperclip.copy(ip) #Recordemos que en la variable ip se pega cada ip del documento, y que en cada iteracion, esta pega un salto de linea 
        pyautogui.hotkey('ctrl', 'v', interval=0.15) #le indicamos las teclas que indican el PEGAR. en interavlos de 15 segundos
        pyautogui.press("enter") #presiona enter
elif eleccion == "2":
    for ip in documento:
        webbrowser.open_new("https://www.abuseipdb.com/")#abrimos la url de AbuseIP
        time.sleep(3) #le indicamos un tiempo de espera apenas abra la pagina (para que esta se cargue correctamente)
        for i in range(15):         #utilizamos este for, ya que la barra de bsuqueda de ip, se encuentra a 15 tabulaciones del inicio
            pyautogui.press('tab')  #asi poder pegar las ip en el lugar correcto
        pyperclip.copy(ip) #Recordemos que en la variable ip se pega cada ip del documento, y que en cada iteracion, esta pega un salto de linea 
        pyautogui.hotkey('ctrl', 'v', interval=0.15)#le indicamos las teclas que indican el PEGAR. en interavlos de 15 segundos
        pyautogui.press("enter")#presiona enter
elif eleccion == "3":
    webbrowser.open_new("https://ww.virustotal.com/gui/home/search")
    time.sleep(3)
    for i in range(6):         #utilizamos este for, ya que la barra de bsuqueda de ip, se encuentra a 6 tabulaciones del inicio
        pyautogui.press('tab')
    pyperclip.copy(ip) #Recordemos que en la variable ip se pega cada ip del documento, y que en cada iteracion, esta pega un salto de linea 
    pyautogui.hotkey('ctrl', 'v', interval=0.15)#le indicamos las teclas que indican el PEGAR. en interavlos de 15 segundos
    pyautogui.press("enter")#presiona enter
else:
    print("Error!! hay que insertar un numero del 1 al 3")

